name: Get Project ID

on:
  issues:
    types: [opened]

jobs:
  get_project_id:
    runs-on: ubuntu-latest

    steps:
      - name: Get event
        id: get_project_id
        run: |
          response=$(curl -L \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: token ${{ secrets.MY_PAT }}" \
            -H "Accept: application/vnd.github+json" \
            https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.issue.number }}/events)

          echo "Response: $response"  # Logowanie odpowiedzi

          # Sprawdzenie, czy zdarzenie added_to_project jest obecne
          project_id=$(echo "$response" | jq -r '.[] | select(.event == "added_to_project") | .project.id' | head -n 1)

  
          echo "No project ID found. issues --> ${{ github.event.issue.number }}, repo --> ${{ github.repository }}"
 

      - name: Output Project ID
        run: |
          echo "The project ID is: $PROJECT_ID"
